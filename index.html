<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>薬価差計算ツールβ（2025.4時点）</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f9f9f9;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    h2 {
      text-align: center;
      color: #2c3e50;
    }
    .container {
      max-width: 700px;
      margin: 0 auto;
      background: white;
      padding: 25px 30px;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
    }
    label {
      font-weight: 600;
      display: block;
      margin-top: 20px;
      margin-bottom: 5px;
    }
    select {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 14px;
    }
    .result-box {
      margin-top: 25px;
      padding: 15px;
      border-radius: 10px;
      background: #f0f4f8;
    }
    .result-box h3 {
      margin-bottom: 10px;
      color: #34495e;
    }
    .increase {
      color: #e74c3c;
      font-weight: bold;
    }
    .decrease {
      color: #3498db;
      font-weight: bold;
    }
    p {
      margin: 5px 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>薬価差計算ツールβ（2025.4時点） </h2>

    <label>カテゴリ:</label>
    <select id="category"></select>

    <label>変更前（現在服用中）:</label>
    <select id="drugA"></select>
    <label>錠数（1日あたり）:</label>
    <select id="dosageA"></select>

    <label>変更後（切り替え候補）:</label>
    <select id="drugB"></select>
    <label>錠数（1日あたり）:</label>
    <select id="dosageB"></select>

    <div class="result-box">
      <h3>結果</h3>
      <div id="result"></div>
    </div>
  </div>

  <script>
    const drugData = {
      "RAAS阻害薬": [
        { name: "エナラプリル錠「オーハラ」", prices: { "2.5mg": 10.4, "5mg": 10.4, "10mg": 10.4 } },
        { name: "アジルサルタン錠「武田テバ」", prices: { "10mg": 20.0, "20mg": 30.2, "40mg": 45.0 } },
        { name: "オルメサルタンOD錠「DSEP」", prices: { "10mg": 10.4, "20mg": 18.0, "40mg": 25.3 } },
        { name: "テルミサルタン錠「DSEP」", prices: { "20mg": 10.4, "40mg": 17.3, "80mg": 25.6 } },
        { name: "バルサルタン錠「サンド」", prices: { "40mg": 10.4, "80mg": 13.2 } },
        { name: "エンレスト", prices: { "50mg": 60.9, "100mg": 106.9, "200mg": 188.2 } }
      ],
      "β遮断薬": [
        { name: "カルベジロール錠「サワイ」", prices: { "1.25mg": 10.4, "2.5mg": 10.4, "10mg": 10.4, "20mg": 17.5 } },
        { name: "ビソプロロール錠「サワイ」", prices: { "0.625mg": 10.4, "2.5mg": 10.4, "5mg": 10.4 } }
      ],
      "MRA": [
        { name: "アルダクトンA", prices: { "25mg": 13.1, "50mg": 27.2} },
        { name: "セララ", prices: { "25mg": 20.6, "50mg": 40.2 } },
        { name: "ケレンディア", prices: { "10mg": 143.9, "20mg": 205.8 } }
      ],
      "SGLT2阻害薬": [
        { name: "ジャディアンス", prices: { "10mg": 188.9, "25mg": 322.6} },
        { name: "フォシーガ", prices: { "5mg": 163.3, "10mg": 240.2 } }
      ],
      "抗血小板薬": [
        { name: "バイアスピリン", prices: { "100mg": 5.9 } },
        { name: "エフィエント", prices: { "3.75mg": 248.8, "5mg": 326 } },
        { name: "クロピドグレル錠「SANIK」", prices: { "25mg": 14.8, "75mg": 31.9 } }
      ],
      "PPI/PCAB/H2B": [
        { name: "タケキャブ", prices: { "10mg": 94.3, "20mg": 141 } },
        { name: "ラベプラゾール錠「AA」", prices: { "10mg": 24.0 } },
        { name: "ランソプラゾールOD錠「武田テバ」", prices: { "15mg": 11.3, "30mg": 19 } },
        { name: "ファモチジンD錠「サワイ」", prices: { "10mg": 10.4, "20mg": 10.4 } }
      ],
      "抗凝固薬": [
        { name: "エリキュース錠", prices: { "2.5mg": 114.7, "5mg": 207.0 } },
        { name: "プラザキサ", prices: { "75mg": 122.4, "110mg": 216.6 } },
        { name: "リクシアナOD錠", prices: { "15mg": 224.7, "30mg": 411.3, "60mg": 416.8 } },
        { name: "リバーロキサバンOD錠「バイエル」", prices: { "10mg": 161.3, "15mg": 226.7 } }
      ]
    };

    const categorySelect = document.getElementById('category');
    const drugASelect = document.getElementById('drugA');
    const drugBSelect = document.getElementById('drugB');
    const dosageA = document.getElementById('dosageA');
    const dosageB = document.getElementById('dosageB');
    const resultDiv = document.getElementById('result');

    Object.keys(drugData).forEach(cat => {
      const opt = document.createElement('option');
      opt.value = cat;
      opt.textContent = cat;
      categorySelect.appendChild(opt);
    });

    function populateDosage(select) {
      select.innerHTML = '';
      for (let i = 0.5; i <= 5; i += 0.5) {
        const opt = document.createElement('option');
        opt.value = i;
        opt.textContent = `${i} 錠`;
        select.appendChild(opt);
      }
      select.value = "1";
    }

    populateDosage(dosageA);
    populateDosage(dosageB);

    categorySelect.addEventListener('change', () => {
      updateDrugSelects();
      updateResult();
    });

    [drugASelect, drugBSelect, dosageA, dosageB].forEach(el => {
      el.addEventListener('change', updateResult);
    });

    function updateDrugSelects() {
      const selectedCategory = categorySelect.value;
      const drugs = drugData[selectedCategory];

      [drugASelect, drugBSelect].forEach(select => {
        select.innerHTML = '';
        drugs.forEach(drug => {
          Object.entries(drug.prices).forEach(([dose, price]) => {
            const opt = document.createElement('option');
            opt.value = `${drug.name}|||${dose}`;
            opt.textContent = `${drug.name} ${dose}`;
            opt.dataset.price = price;
            select.appendChild(opt);
          });
        });
      });
    }

    function updateResult() {
      const getPrice = (select, dosageSelect) => {
        if (!select.value) return 0;
        const price = parseFloat(select.selectedOptions[0].dataset.price);
        const dose = parseFloat(dosageSelect.value);
        return price * dose;
      };

      const priceA = getPrice(drugASelect, dosageA);
      const priceB = getPrice(drugBSelect, dosageB);
      const diff = priceB - priceA;
      const sign = diff > 0 ? '▲' : diff < 0 ? '▼' : '';
      const className = diff > 0 ? 'increase' : diff < 0 ? 'decrease' : '';
      const monthly = diff * 30;

      resultDiv.innerHTML = `
        <p>変更前: ${priceA.toFixed(2)} 円/日</p>
        <p>変更後: ${priceB.toFixed(2)} 円/日</p>
        <p class="${className}">差額: ${sign} ${Math.abs(diff).toFixed(2)} 円/日</p>
        <p class="${className}">月額換算: ${sign} ${Math.abs(monthly).toFixed(0)} 円/月</p>
      `;
    }

    categorySelect.value = Object.keys(drugData)[0];
    updateDrugSelects();
    updateResult();
  </script>
</body>
</html>